<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="We propose an optimality criterion to determine the required training set, r-score, which is derived directly from Pearson's correlation between the genomic estimated breeding values and phenotypic values of the test set &lt;doi:10.1007/s00122-019-03387-0&gt;. This package provides two main functions to determine a good training set and its size.">
<title>Training Set Determination For Genomic Selection • TSDFGS</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Training Set Determination For Genomic Selection">
<meta property="og:description" content="We propose an optimality criterion to determine the required training set, r-score, which is derived directly from Pearson's correlation between the genomic estimated breeding values and phenotypic values of the test set &lt;doi:10.1007/s00122-019-03387-0&gt;. This package provides two main functions to determine a good training set and its size.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">TSDFGS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="tsdfgs">TSDFGS<a class="anchor" aria-label="anchor" href="#tsdfgs"></a>
</h1></div>
<!-- badges: start -->

<p>This package provides two useful tools for determining a proper training set for genomic selection or prediction. In order to have a better prediction of the genomic estimated breeding values (GEBV), the training set should be optimized as highly genomic correlated with the test set as possible. Several criteria have been published previously, including:</p>
<ul>
<li>Prediction error variance (PEV; <a href="https://doi.org/10.1186/s12711-015-0116-6" class="external-link">Akdemir et al., 2015</a>)</li>
<li>Generalized coefficient of determination (CD; <a href="https://doi.org/10.1186/1297-9686-28-4-359" class="external-link">Laloë et al., 1993</a>)</li>
</ul>
<p>Our research provides an alternative criterion, <strong>r-score</strong>, which is derived from Pearson’s correlation between GEBVs and phenotypic values of a test set. We could determine both a reasonable training set size and an optimal training set for building a prediction model with the criteria. Both functions are provided in our package.</p>
<p>For more information on the method, please check our published article:</p>
<ul>
<li>Training set determination for genomic selection (<a href="https://doi.org/10.1007/s00122-019-03387-0" class="external-link">Ou et al., 2019</a>)</li>
</ul>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The development version of TSDFGS can be installed from GitHub (recommend):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># library(devtools)</span></span>
<span><span class="fu">install_github</span><span class="op">(</span><span class="st">"oumarkme/TSDFGS"</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span>, force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>You may also install the stable version from CRAN, which the most recent function may not include.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"TSDFGS"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>All functions were developed under r version 4.2.0 and tested in both version 3.6.3 and 4.1.1. However, we recommend you to use this package with R version &gt; 3.6.3.</li>
<li>Rcpp and RcppEigen were used in the package. In addition, the core C++ scripts were published on GitHub for those who want a better performance.</li>
</ul>
</div>
<div class="section level2">
<h2 id="main-functions">Main functions<a class="anchor" aria-label="anchor" href="#main-functions"></a>
</h2>
<ul>
<li>
<code>r_score</code>: Function for calculating r-score (<a href="https://www.oumark.me/TSDFGS/reference/r_score.html" class="external-link">more</a>).</li>
<li>
<code>pev_score</code>: Function for calculating PEV score (<a href="https://www.oumark.me/TSDFGS/reference/pev_score.html" class="external-link">more</a>).</li>
<li>
<code>cd_score</code>: Function for Calculating CD score (<a href="https://www.oumark.me/TSDFGS/reference/cd_score.html" class="external-link">more</a>).</li>
<li>
<code>optTrain</code>: Function for determining optimal training set (<a href="https://www.oumark.me/TSDFGS/reference/optTrain.html" class="external-link">more</a>).</li>
<li>
<code>SSDFGS</code>: Function for determining reasonable training set size (<a href="https://www.oumark.me/TSDFGS/reference/SSDFGS.html" class="external-link">more</a>).</li>
</ul>
<p>Note that <code><a href="reference/cd_score.html">cd_score()</a></code> and <code><a href="reference/pev_score.html">pev_score()</a></code> are using functions from <a href="https://CRAN.R-project.org/package=STPGA" class="external-link">STPGA</a> package. Try their package for advanced usage.</p>
<p>If you wanted to install the recent version of <code><a href="reference/r_score.html">r_score()</a></code> function independently, you may download the <code>rscore.cpp</code> script from my GitHub repo and install it by:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.rcpp.org" class="external-link">Rcpp</a></span>, <span class="va">RcppEigen</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/oumarkme/TSDFGS/main/src/rscore.cpp"</span>, <span class="st">"rscore.cpp"</span><span class="op">)</span></span>
<span><span class="fu">Rcpp</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Rcpp/man/sourceCpp.html" class="external-link">sourceCpp</a></span><span class="op">(</span><span class="st">"rscore.cpp"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-dataset">Example dataset<a class="anchor" aria-label="anchor" href="#example-dataset"></a>
</h2>
<p>An example data provided for testing this package. The rice genome data was published by <a href="https://doi.org/10.1038/ncomms1467" class="external-link">Zhao et al. (2011)</a> in their research. Raw dataset is available at the <a href="http://www.ricediversity.org/data/" class="external-link">Rice Diversity website</a>. Pre-arranged dataset is available in this GitHub repository and you may loaded in R by</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span><span class="st">"https://github.com/oumarkme/TSDFGS/raw/main/data/geno.rda"</span>, <span class="st">"geno.rda"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="st">"geno.rda"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="authors">Authors<a class="anchor" aria-label="anchor" href="#authors"></a>
</h2>
<ul>
<li>Jen-Hsiang Ou
<ul>
<li>Author, maintainer</li>
<li>E-mail: <a href="mailto:jen-hsiang.ou@imbim.uu.se" class="email">jen-hsiang.ou@imbim.uu.se</a>
</li>
<li>Department of Medical Biochemistry and Microbiology, Uppsala University, Uppsala, Sweden</li>
</ul>
</li>
<li>Po-Ya Wu
<ul>
<li>Author</li>
<li>E-mail: <a href="mailto:Po-Ya.Wu@hhu.de" class="email">Po-Ya.Wu@hhu.de</a>
</li>
<li>Institute for Quantitative Genetics and Genomics of Plants, Heinrich Heine University, Düsseldorf, Germany</li>
</ul>
</li>
<li>Chen-Tuo Liao
<ul>
<li>Author, thesis advisor</li>
<li>E-mail: <a href="mailto:ctliao@ntu.edu.tw" class="email">ctliao@ntu.edu.tw</a>
</li>
<li>Department of Agronomy, National Taiwan University, Taipei, Taiwan</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="citing-this-package">Citing this package<a class="anchor" aria-label="anchor" href="#citing-this-package"></a>
</h2>
<p>If you make use of TSDFGS package in your research, we would appreciate a citation of following papers:</p>
<ul>
<li>Ou, J.-H., and Liao, C.-T. Training set determination for genomic selection. Theoretical and Applied Genetics 132, 2781–2792 (2019). <a href="https://doi.org/10.1007/s00122-019-03387-0" class="external-link">https://doi.org/10.1007/s00122-019-03387-0</a>
</li>
<li>Wu, P.-Y., Ou, J.-H., and Liao, C.-T. Sample size determination for training set optimization in genomic prediction. Theoretical and Applied Genetics 136, 57 (2023). <a href="https://doi.org/10.1007/s00122-023-04254-9" class="external-link">https://doi.org/10.1007/s00122-023-04254-9</a>
</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=TSDFGS" class="external-link">View on CRAN</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing TSDFGS</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Jen-Hsiang Ou <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-9305-2931" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Po-Ya Wu <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-7342-2867" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Chen-Tuo Liao <br><small class="roles"> Author, thesis advisor </small> <a href="https://orcid.org/0000-0001-9777-3701" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://CRAN.R-project.org/package=TSDFGS" class="external-link"><img src="https://www.r-pkg.org/badges/version/TSDFGS" alt="CRAN status"></a></li>
<li><a href="https://github.com/oumarkme/TSDFGS/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/oumarkme/TSDFGS/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="Lifecycle: stable"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jen-Hsiang Ou, Po-Ya Wu, Chen-Tuo Liao.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
